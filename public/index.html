<!DOCTYPE html>
<html>
  <head>
    <title>Tangelo</title>
    <link rel="stylesheet" type="text/css" href="/css/main.css">
  </head>
  <body>
    <script src="/js/main.js"></script>
    <script>
      var tantaloWorker = new Worker ("/js/tantalo.js");
      var app = Elm.Main.fullscreen(loadConfig());

      app.ports.generateEdges.subscribe(function(difficulty) {
        console.log("Generating difficulty of " + difficulty + "...");
        tantaloWorker.postMessage(difficulty);
      });

      tantaloWorker.onmessage = function(event) {
        var edgeData = event.data;
        app.ports.generatedEdges.send(edgeData);
      };

      app.ports.saveConfig.subscribe(function(config) {
        console.log("Saving config:", config);
        localStorage.setItem("config:radius", config.radius);
      });

      function loadConfig() {
        var config = {
          radius: parseFloat(localStorage.getItem("config:radius")) || 25,
        };
        console.log("Loading config:", config);
        return config;
      }
    </script>
  </body>
</html>
